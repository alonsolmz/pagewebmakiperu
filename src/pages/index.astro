---
import Layout from '../layouts/Layout.astro';
import { supabase } from '../lib/supabase';
import '../styles/global.css';
import { Image } from 'astro:assets';

// Asegúrate de que la imagen esté en src/assets/
import heroImg from '../assets/maquinariaimagen.png'; 

const { data: vehiculos, error } = await supabase
  .from('vehiculos')
  .select('*')
  .order('created_at', { ascending: false });

if (error) console.error(error);
---

<Layout title="MaquiPeru | Maquinaria Pesada">
	<div class="bg-[#f2f4f7] min-h-screen py-10 md:py-20 px-8 md:px-24 lg:px-40">
		
		<div class="relative overflow-hidden shadow-2xl" style="border-radius: 24px;">
			
			<header class="absolute top-0 left-0 w-full z-50 bg-gradient-to-b from-black/70 to-transparent">
				<div class="max-w-7xl mx-auto px-10 h-24 flex items-center justify-between">
					<a href="/" class="text-3xl font-black text-white tracking-tighter">
						MAQUI<span class="text-yellow-500">PERU</span>
					</a>
					<nav class="hidden md:flex items-center gap-12">
						<a href="/" class="text-[11px] font-black text-white/90 hover:text-yellow-500 transition-colors uppercase tracking-[0.25em]">Inicio</a>
						<a href="#nosotros" class="text-[11px] font-black text-white/90 hover:text-yellow-500 transition-colors uppercase tracking-[0.25em]">Nosotros</a>
						<a href="#grid-vehiculos" class="text-[11px] font-black text-white/90 hover:text-yellow-500 transition-colors uppercase tracking-[0.25em]">Catálogo</a>
					</nav>
					<div class="w-32 md:block hidden"></div> 
				</div>
			</header>

			<section class="relative h-[450px] md:h-[600px]">
				<Image 
					src={heroImg} 
					alt="Maquinaria MaquiPeru" 
					class="absolute inset-0 w-full h-full object-cover"
                    style="border-radius: 24px;"
				/>
				<div class="absolute inset-0 bg-black/20 flex items-center px-10 md:px-20">
					<div class="max-w-2xl mt-20">
						<h1 class="text-6xl md:text-8xl font-black text-white mb-4 italic tracking-tighter leading-[0.9]">
							POTENCIA Y MOVIMIENTO
						</h1>
						<p class="text-xl md:text-2xl text-white/90 font-light italic tracking-wide">
							Soluciones para cada gran proyecto.
						</p>
					</div>
				</div>
			</section>
		</div>

		<div class="h-20 md:h-32"></div>

		<section id="nosotros" class="bg-white py-24 px-10 md:px-24 shadow-sm border border-gray-100" style="border-radius: 24px;">
			<div class="max-w-4xl mx-auto text-center">
				<h2 class="text-2xl font-black text-slate-900 mb-10 uppercase tracking-[0.4em]">
					<span class="border-b-4 border-yellow-500 pb-2">Nosotros</span>
				</h2>
				<div class="text-slate-600 leading-relaxed text-xl italic space-y-8 font-medium">
					<p>
						La confianza en el sector industrial se construye a través de resultados. En <strong>MaquiPeru</strong>, seleccionamos rigurosamente cada unidad de nuestro catálogo para asegurar que cumpla con los estándares de ingeniería más elevados.
					</p>
					<p>
						Nos especializamos en proveer equipos que combinan potencia y fiabilidad, permitiendo que las empresas peruanas superen sus metas con la seguridad de contar con el mejor respaldo técnico del mercado.
					</p>
				</div>
			</div>
		</section>

		<div class="h-20 md:h-32"></div>

		<section id="grid-vehiculos" class="space-y-16">
			<div class="flex flex-col md:flex-row justify-between items-center gap-6">
				<div class="flex gap-3 overflow-x-auto w-full md:w-auto pb-4 md:pb-0 no-scrollbar">
					<button class="filter-btn active bg-slate-900 text-white px-8 py-3 rounded-xl font-black text-[10px] uppercase tracking-widest transition-all" data-category="Todos">Todos</button>
					<button class="filter-btn bg-white text-slate-400 px-8 py-3 rounded-xl font-black text-[10px] uppercase tracking-widest hover:bg-yellow-500 hover:text-slate-900 transition-all shadow-sm" data-category="Linea Amarilla">Línea Amarilla</button>
					<button class="filter-btn bg-white text-slate-400 px-8 py-3 rounded-xl font-black text-[10px] uppercase tracking-widest hover:bg-yellow-500 hover:text-slate-900 transition-all shadow-sm" data-category="Volquetes">Volquetes</button>
					<button class="filter-btn bg-white text-slate-400 px-8 py-3 rounded-xl font-black text-[10px] uppercase tracking-widest hover:bg-yellow-500 hover:text-slate-900 transition-all shadow-sm" data-category="Mineria">Minería</button>
				</div>
				<select id="priceFilter" class="bg-white border-none rounded-xl px-6 py-3 font-bold text-slate-700 text-xs outline-none cursor-pointer w-full md:w-56 shadow-sm ring-1 ring-gray-100">
					<option value="all">Presupuesto Máximo</option>
					<option value="20">Hasta $20,000</option>
					<option value="40">Hasta $40,000</option>
					<option value="60">Hasta $60,000</option>
					<option value="80">Hasta $80,000</option>
					<option value="100">Hasta $100,000</option>
				</select>
			</div>

			<div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-12">
				{vehiculos?.map((item) => (
					<div class="vehiculo-card bg-white overflow-hidden shadow-sm hover:shadow-2xl transition-all duration-700 group border border-gray-50" 
                         style="border-radius: 24px;"
						 data-category={item.categoria} 
						 data-price={item.precio || 0}>
						
						<div class="relative aspect-[4/3] overflow-hidden">
							<Image src={item.imagen_url} alt={item.nombre} width={600} height={450} class="w-full h-full object-cover group-hover:scale-110 transition-transform duration-1000" />
						</div>
						
						<div class="p-10 text-center">
							<h2 class="text-2xl font-black text-slate-900 mb-8 uppercase tracking-tighter italic leading-tight">
								{item.nombre}
							</h2>
							
							<a href={`https://wa.me/51968348172?text=Hola%20MaquiPeru,%20solicito%20cotización%20del%20equipo:%20${item.nombre}`} 
							   target="_blank"
							   class="bg-slate-900 text-white block w-full py-5 rounded-2xl text-[11px] font-black uppercase tracking-[0.25em] hover:bg-yellow-500 hover:text-slate-900 transition-all shadow-xl shadow-slate-100">
								Cotizar por WhatsApp
							</a>
						</div>
					</div>
				))}
			</div>
		</section>
	</div>
</Layout>